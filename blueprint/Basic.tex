
This project aims to formalize a proof that holomorphic functions on discs have primitives.


\begin{definition}[Rectangle]
  \label{Rectangle}
  \lean{Rectangle}\leanok
    Given points $z$ and $w$ in $\mathbb C$, a ``Rectangle'' means an axis-parallel rectangle with
    corners $z$ and $w$.
\end{definition}


\begin{definition}[Has Primitives]
  \label{HasPrimitives}
  \lean{HasPrimitives}\leanok
  Given a set $U\subset\mathbb C$, for any differentiable $f:U\to\mathbb C$, there exists a
  differentiable $g:U\to\mathbb C$ such that $g'=f$ on $U$.
\end{definition}


A wedge is the union of a horizontal line and a vertical line.

\begin{definition}[Wedge Integral]
  \label{WedgeInt}
  \lean{WedgeInt}\leanok
  \uses{linint}
  Given $z,w\in\mathbb C$ and a function $f:\mathbb C\to\mathbb C$, the wedge integral from
  $z$ to $w$ is defined as the sum of two complex integrals, one along the horizontal path
  from $z$ to $\Re(w)+i \Im(z)$, and another along a vertical path from there to $w$,
   \begin{equation}
      \int_{z\to_W\  w} f(x)\ dx
      :=
      \int_{\Re(z)}^{\Re(w)} f(x+i\Im(z))\ dx
      +
      i\int_{\Im(z)}^{\Im(w)} f(\Re(w)+iy)\ dy
      .
   \end{equation}
\end{definition}


A ``Rectangle Integral'' is what it sounds like.

\begin{definition}[Rectangle Integral]
  \label{RectangleIntegral}
  \lean{RectangleIntegral}\leanok
  Given $z,w\in\mathbb C$ and a function $f:\mathbb C\to\mathbb C$, the rectangle integral is
  defined as the sum of four complex integrals:
   \begin{equation}
      \int_{R(z,w)} f(x)\ dx
      :=
      \int_{\Re(z)}^{\Re(w)} f(x+i\Im(z))\ dx
      -
      \int_{\Re(z)}^{\Re(w)} f(x+i\Im(w))\ dx
      +
      i\int_{\Im(z)}^{\Im(w)} f(\Re(w)+iy)\ dy
      -
      i\int_{\Im(z)}^{\Im(w)} f(\Re(z)+iy)\ dy
      .
   \end{equation}
\end{definition}


We say that a function $f$ ``vanishes on rectangles in a disc'', $D(c,r)$ if, for any rectangle
contained in $D(c,r)$, the integral of $f$ over the rectangle is zero.
\begin{definition}[Vanishes On Rectangles In Disc]
  \label{VanishesOnRectanglesInDisc}
  \lean{VanishesOnRectanglesInDisc}\leanok
  A function $f:\mathbb C\to\mathbb C$ vanishes on rectangles in a disc $D(c,r)$ if, for any
  rectangle $R(z,w)$ contained in $D(c,r)$, the integral of $f$ over the rectangle is zero.
\end{definition}


If a function $f$ vanishes on rectangles in a disc $D(c,r)$, then, for any $w$ in a neighborhood
of $z$ in $D(c,r)$, the wedge integral from $c$ to $w$ minus the wedge integral from $c$ to $z$
is equal to the wedge integral from $z$ to $w$.
\begin{lemma}[Wedge Integral Difference]
  \label{diff_of_wedges}
  \lean{VanishesOnRectanglesInDisc.diff_of_wedges}\leanok
  \uses{VanishesOnRectanglesInDisc}
  If a function $f$ vanishes on rectangles in a disc $D(c,r)$, then, for any $w$ in a
  neighborhood of $z$ in $D(c,r)$,
  $$
    \int_{c\to_W\  w} f(x)\ dx
    -
    \int_{c\to_W\  z} f(x)\ dx
    =
    \int_{z\to_W\  w} f(x)\ dx
    .
  $$
\end{lemma}

 \begin{proof}
 Set $r_1>0$ to be the distance from $z$ to the boundary of $D(c,r)$,
 so that the disc $D(z,r_1)$ is contained in $D(c,r)$.
 Then for $w$ to be in a ``neighborhood of $z$'', it suffices to be in $D(z,r_1)$.
 It is convenient to name some of the arising line integrals, to be used again and again.
 We define $I_1$ to be the integral along the horizontal path from $c$ to $\Re(w)+i\Im(c)$.
 We define $I_2$ to be the integral along the vertical path from $\Re(w)+i\Im(c)$ to $w$.
 We define $I_3$ to be the integral along the horizontal path from $c$ to $\Re(z)+i\Im(c)$.
 We define $I_4$ to be the integral along the vertical path from $\Re(z)+i\Im(c)$ to $z$.
 We define $I_5$ to be the integral along the horizontal path from $z$ to $\Re(w)+i\Im(z)$.
 We define $I_6$ to be the integral along the vertical path from $\Re(w)+i\Im(z)$ to $w$.
 We define $I_7$ to be the integral along the horizontal path from $\Re(z)+i\Im(c)$ to
 $\Re(w)+i\Im(c)$.
 We define $I_8$ to be the integral along the vertical path from $\Re(w)+i\Im(c)$ to
 $\Re(w)+i\Im(z)$.
 Then $I_1$ is equal to $I_3+I_7$,
 and $I_2$ is equal to $I_6+I_8$.
 Moreover, $I_7 - I_5 + I_8 - I_4$ forms a rectangle, and hence its integral is zero.
 Putting everything together shows that the wedge integral difference is equal to the wedge,
 as claimed.
 \end{proof}

Next we claim that, as $x \to \Re(z)$, the horizontal integral of a continuous $f$
from $z$ to $x + i\Im(z)$ is equal to $(x - \Re(z)) f(z)$, up to $o(x - \Re(z))$.
\begin{lemma}
  \label{deriv_of_wedgeInt_re'}
  \lean{deriv_of_wedgeInt_re'}\leanok
  As $x \to \Re(z)$,
  $$
    \int_{\Re(z)}^x f(t + i\Im(z))\ dt
    =
    (x-\Re(z)) f(z)
    +
    o(x-\Re(z))
    .
  $$
\end{lemma}

 \begin{proof}
 This is just the fundamental theorem of calculus.
 \end{proof}

Therefore as the complex varialbe $w \to z$, the horizontal integral of $f$ from $z$ to
$\Re(w)+i\Im(z)$ is equal to $(\Re(w - z)) f(z)$, up to $o(w - z)$.
\begin{lemma}
  \label{deriv_of_wedgeInt_re}
  \lean{deriv_of_wedgeInt_re}\leanok
  As $w \to z$,
  $$
    \int_{\Re(z)}^{\Re(w)} f(t + i\Im(z))\ dt
    =
    (\Re(w-z)) f(z)
    +
    o(w-z)
    .
  $$
\end{lemma}

 \begin{proof}
 Simply apply the previous lemma, together with the fact that $\Re(w - z) = O(w - z)$ as $w \to z$.
 \end{proof}

Similarly, as $y \to \Im(z)$, the vertical integral of $f$ from $z$ to $\Re(z)+iy$ is equal to
$(y - \Im(z)) f(z)$, up to $o(y - \Im(z))$.
\begin{lemma}
  \label{deriv_of_wedgeInt_im'}
  \lean{deriv_of_wedgeInt_im'}\leanok
  As $y \to \Im(z)$,
  $$
    \int_{\Im(z)}^y f(\Re(z)+it)\ dt
    =
    (y-\Im(z)) f(z)
    +
    o(y-\Im(z))
    .
  $$
\end{lemma}
The proof is the same.


As before, we extend this to the setting where $w$ is in a neighborhood of $z$.
\begin{lemma}
  \label{deriv_of_wedgeInt_im''}
  \lean{deriv_of_wedgeInt_im''}\leanok
  As $w \to z$,
  $$
    \int_{\Im(z)}^{\Im(w)} f(\Re(z)+iy)\ dy
    =
    (\Im(w-z)) f(z)
    +
    o(w-z)
    .
  $$
\end{lemma}
The proof is again the same


It turns out that the above lemma is subtly different from what is needed in the application.
We need not the integral of $f(\Re(z)+iy)$, but rather the integral of $f(\Re(w)+iy)$. These are
still close as $w \to z$. This lemma prepares for the real thing.
\begin{lemma}
  \label{deriv_of_wedgeInt_im'''}
  \lean{deriv_of_wedgeInt_im'''}
  As $w \to z$,
  $$
    \int_{\Im(z)}^{\Im(w)} (f(\Re(w)+iy) - f (z))\ dy
    =
    o(w-z)
    .
  $$
\end{lemma}

 \begin{proof}
 \end{proof}

This is Moreira's theorem.
\begin {theorem}[Moreira's theorem]
\label {moreira}
\lean {moreira}\leanok
Let $f$ be a continuous function on a disc $D(c,r)$, and suppose that $f$ vanishes on rectangles in $D(c,r)$. Then $f$ has a primitive on $D(c,r)$.
\end {theorem}

